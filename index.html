<!DOCTYPE html>
<html lang="mn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–¶–∞–≥ –ê–≥–∞–∞—Ä—ã–Ω –ú—ç–¥—ç—ç: –û–¥–æ–æ –±–∞ 5 –•–æ–Ω–æ–≥</title>
  <link rel="stylesheet" href="style.css" /> 
</head>
<body>
  <div class="container">
    <h1>–¶–∞–≥ –ê–≥–∞–∞—Ä—ã–Ω –£—Ä—å–¥—á–∏–ª—Å–∞–Ω –ú—ç–¥—ç—ç</h1>

    <form id="weatherForm">
      <input type="text" id="cityInput" placeholder="–•–æ—Ç—ã–Ω –Ω—ç—Ä (–∂: Ulaanbaatar)" required />
      <button type="submit">–•–∞—Ä–∞—Ö</button>
    </form>

    <div id="forecastContainer" class="hidden">
      <h2 id="forecastCity"></h2>
      
      <h3 style="margin-bottom: 10px;">–û–¥–æ–æ–≥–∏–π–Ω –±–∞–π–¥–∞–ª</h3>
      <div id="currentWeatherCard" class="current-weather-card">
        </div>
      
      <h3 style="margin-top: 30px; margin-bottom: 10px;">5 —Ö–æ–Ω–æ–≥–∏–π–Ω —É—Ä—å–¥—á–∏–ª—Å–∞–Ω –º—ç–¥—ç—ç (12:00 —Ü–∞–≥–∞–∞—Ä)</h3>
      <div id="forecast" class="forecast-grid"></div>
    </div>
  </div>

  <script>
    const form = document.getElementById("weatherForm");
    const cityInput = document.getElementById("cityInput");
    const forecastContainer = document.getElementById("forecastContainer");
    const forecastCity = document.getElementById("forecastCity");
    const forecast = document.getElementById("forecast");
    // üÜï –û–¥–æ–æ–≥–∏–π–Ω –º—ç–¥—ç—ç–Ω–∏–π –∫–∞—Ä—Ç
    const currentWeatherCard = document.getElementById("currentWeatherCard"); 

    form.addEventListener("submit", function (e) {
      e.preventDefault();
      const city = cityInput.value.trim();
      if (!city) return;

      const apiKey = "5f5001c381997c6da9f3050d27ba4ec5";
      
      // üÜï 1. –û–¥–æ–æ–≥–∏–π–Ω —Ü–∞–≥ –∞–≥–∞–∞—Ä—ã–Ω API URL
      const currentUrl = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric&lang=mn`;
      // 2. 5 —Ö–æ–Ω–æ–≥–∏–π–Ω —É—Ä—å–¥—á–∏–ª—Å–∞–Ω –º—ç–¥—ç—ç–Ω–∏–π API URL
      const forecastUrl = `https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${apiKey}&units=metric&lang=mn`;
      
      // üÜï Promise.all-–∞–∞—Ä 2 —Ö“Ø—Å—ç–ª—Ç–∏–π–≥ –∑—ç—Ä—ç–≥ –∏–ª–≥—ç—ç–∂, —Ö–æ—ë—É–ª–∞–Ω–≥–∏–π–Ω—Ö –Ω—å —Ö–∞—Ä–∏—É–≥ —Ö“Ø–ª—ç—ç–∂ –∞–≤–Ω–∞
      Promise.all([
        fetch(currentUrl).then(res => res.json()),
        fetch(forecastUrl).then(res => res.json())
      ])
      .then(([currentData, forecastData]) => {
          // –•—ç—Ä—ç–≤ –∞–ª—å –Ω—ç–≥ –º—ç–¥—ç—ç–ª—ç–ª –∞–ª–¥–∞–∞—Ç–∞–π (—Ö–æ—Ç –æ–ª–¥—Å–æ–Ω–≥“Ø–π) –±–æ–ª
          if (currentData.cod !== 200) {
              throw new Error("–•–æ—Ç –æ–ª–¥—Å–æ–Ω–≥“Ø–π.");
          }

          // === 1. –û–¥–æ–æ–≥–∏–π–Ω –¶–∞–≥ –ê–≥–∞–∞—Ä—ã–Ω –ú—ç–¥—ç—ç–≥ –•–∞—Ä—É—É–ª–∞—Ö (Current Weather) ===
          const current = currentData; 
          forecastCity.textContent = `${current.name}, ${current.sys.country}`;
          currentWeatherCard.innerHTML = ""; 

          const date = new Date(current.dt * 1000);
          const options = { hour: "2-digit", minute: "2-digit" };
          const time = date.toLocaleTimeString("mn-MN", options); 

          const icon = current.weather[0].icon;
          const description = current.weather[0].description;
          const temp = current.main.temp.toFixed(1); // 1 –±—É—Ç–∞—Ä—Ö–∞–π —Ç–æ–æ—Ç–æ–π
          const wind = current.wind.speed.toFixed(1);

          currentWeatherCard.innerHTML = `
              <h4>${time}</h4>
              <img src="https://openweathermap.org/img/wn/${icon}@4x.png" alt="${description}" />
              <p class="description">${description}</p>
              <p class="temperature"><strong>${temp}¬∞C</strong></p>
              <p>–°–∞–ª—Ö–∏: ${wind} –º/—Å | –ß–∏–π–≥—à–∏–ª: ${current.main.humidity}%</p>
          `;

          // === 2. 5 –•–æ–Ω–æ–≥–∏–π–Ω –£—Ä—å–¥—á–∏–ª—Å–∞–Ω –ú—ç–¥—ç—ç–≥ –•–∞—Ä—É—É–ª–∞—Ö (5 Day Forecast) ===
          forecast.innerHTML = "";
          const dailyData = forecastData.list.filter(item => item.dt_txt.includes("12:00:00"));

          dailyData.forEach((day) => {
            const date = new Date(day.dt * 1000);
            const options = { weekday: "short", month: "short", day: "numeric" };
            const dayName = date.toLocaleDateString("mn-MN", options);

            const icon = day.weather[0].icon;
            const description = day.weather[0].description;
            const temp = day.main.temp.toFixed(0); 
            const wind = day.wind.speed.toFixed(1);

            forecast.innerHTML += `
              <div class="forecast-card">
                <h3>${dayName}</h3>
                <img src="https://openweathermap.org/img/wn/${icon}@2x.png" alt="${description}" />
                <p>${description}</p>
                <p><strong>${temp}¬∞C</strong></p>
                <p>–°–∞–ª—Ö–∏: ${wind} –º/—Å</p>
              </div>
            `;
          });

          forecastContainer.classList.remove("hidden");
        })
        .catch((error) => {
          alert(error.message);
          forecastContainer.classList.add("hidden");
        });
    });
  </script>
</body>
</html>
